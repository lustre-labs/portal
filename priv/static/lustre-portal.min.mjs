function q(a,e,n){return a?e:n()}var t=class{withFields(e){let n=Object.keys(this).map(f=>f in e?e[f]:this[f]);return new this.constructor(...n)}};var C=class a extends t{static isResult(e){return e instanceof a}},r=class extends C{constructor(e){super(),this[0]=e}isOk(){return!0}},i=class extends C{constructor(e){super(),this[0]=e}isOk(){return!1}};var at=5,J=Math.pow(2,at),jr=J-1,Er=J/2,Sr=J/4;var ye=[" ","	",`
`,"\v","\f","\r","\x85","\u2028","\u2029"].join(""),Gr=new RegExp(`^[${ye}]*`),Wr=new RegExp(`[${ye}]*$`);var B=()=>globalThis?.document;var Bt=!!globalThis.HTMLElement?.prototype?.moveBefore;var rr=Symbol("lustre");var Ke=a=>!!a[rr];var j=()=>!!B(),ce=a=>j()&&customElements.get(a);var I=class extends t{constructor(e){super(),this.name=e}};var E=class extends t{};function Ze(a){customElements.define(a,_e)}var _e=class a extends HTMLElement{static observedAttributes=["target","root"];#t=null;#e=[];constructor(){super(),this.#t=this.#i(),this.#e=[...super.childNodes]}connectedCallback(){this.style.display="none",this.#n()}disconnectedCallback(){this.#n()}connectedMoveCallback(){}attributeChangedCallback(e,n,f){n!==f&&(this.targetElement=this.#i())}get targetElement(){return this.#t}set targetElement(e){e!==this.#t&&(this.#t=this.#s(e),this.#n())}get target(){return super.getAttribute("target")??""}set target(e){e instanceof HTMLElement?this.targetElement=e:super.setAttribute("target",typeof e=="string"?e:"")}get root(){return super.getAttribute("root")}set root(e){super.setAttribute("root",e!=="relative"&&e!=="document"?"document":e)}#n(){let e=document.createDocumentFragment();for(let n of this.#e)e.appendChild(n);this.isConnected&&this.#t?.insertBefore(e,null)}#i(){if(!this.target)return this.#r(et,"The target attribute cannot be empty.");let e=this.root==="relative"?this.getRootNode():document,n=null;try{n=e.querySelector(this.target)}catch{return this.#r(tt,`The target "${this.target}" is not a valid query selector.`)}return this.#s(n)}#s(e){if(!e)return this.#r(rt,`No element matching "${this.target}".`);if(e instanceof HTMLIFrameElement){let n=e.contentDocument?.body;return n||this.#r(it,"Only same-origin iframes can be targeted.")}return e instanceof a?this.#r(st,`The element matching "${this.target}" must not be another portal.`):Ke(e)?this.#r(nt,`The element matching "${this.target}" must not be owned by Lustre.`):e}#r(e,n="",f={}){return this.dispatchEvent(new CustomEvent("error",{detail:{tag:e,message:n,selector:this.target,...f}})),null}#o(e,n,f){let S=e.nodeType===Node.DOCUMENT_FRAGMENT_NODE?[...e.childNodes]:[e],he=this.#e.indexOf(e),ut=f(e,n??this.lastChild?.nextSibling??null);he>=0&&this.#e.splice(he,1);let lt=n?this.#e.indexOf(n):this.#e.length;return this.#e.splice(lt,0,...S),ut}get childNodes(){return this.#e}get firstChild(){return this.#e[0]}get lastChild(){return this.#e[this.#e.length-1]}moveBefore(e,n){return this.#o(e,n,(f,S)=>{this.#t?.moveBefore(f,S)})}insertBefore(e,n){return this.#o(e,n,(f,S)=>{this.#t?.insertBefore(f,S)})}removeChild(e){let n=this.#e.indexOf(e);this.#t?.removeChild(e),this.#e.splice(n,1)}};var me="lustre-portal";function ot(){return q(!j(),new i(new E),()=>q(ce(me),new i(new I(me)),()=>new r(Ze(me))))}var et="missing-selector",tt="invalid-selector",rt="target-not-found",nt="target-inside-lustre",it="target-is-cross-origin-iframe",st="target-is-portal";ot();
